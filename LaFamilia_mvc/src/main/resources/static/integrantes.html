<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/LaFamilia/css/styleIntegrante.css"> <!-- Agregamos el contexto "LaFamilia" a la ruta de CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech&display=swap" rel="stylesheet">
    <title>Integrantes</title>

    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
    </style>
</head>
<body style="background-color: rgb(61, 56, 56);">
    <h2>Lista Integrantes</h2>
    <table id="integrantesTable">
        <tr>
            <th>Nombre</th>
            <th>PuntosHonor</th>
            <th>DNI</th>
            <th>Acciones</th>
        </tr>
    </table>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        function obtenerIntegrantes() {
            axios.get("/LaFamilia/Integrantes") // Agregamos el contexto "LaFamilia" a la URL de la solicitud
                .then(function (response) {
                    const integrantesTable = document.getElementById("integrantesTable");
                    response.data.forEach(function (integrante) {
                        const row = integrantesTable.insertRow(-1);
                        const nombreCell = row.insertCell(0);
                        const PuntosHonorCell = row.insertCell(1);
                        const DNICell = row.insertCell(2);
                        const accionesCell = row.insertCell(3);

                        nombreCell.innerHTML = integrante.nombre;
                        PuntosHonorCell.innerHTML = integrante.puntosDeHonor;
                        DNICell.innerHTML = integrante.id;
                        accionesCell.innerHTML = '<button class="editar" onclick="editarFila(this)">Editar</button>' +
                            '<button class="eliminar" onclick="eliminarFila(' + integrante.id + ')">Eliminar</button>';
                    });
                })
                .catch(function (error) {
                    console.error("Error al obtener la lista de integrantes:", error);
                });
        }

        function eliminarFila(dni) {
            axios.delete("/LaFamilia/Borrar/Integrante/" + dni)
                .then(function (response) {
                    console.log(response);
                    console.log("Se logr√≥ eliminar el integrante respetable");
                    window.location.href = "http://localhost:8080/LaFamilia/integrantes.html";
                })
                .catch(function (error) {
                    console.error("Error al eliminar el integrante:", error);
                });
        }

        obtenerIntegrantes();
    </script>
</body>
</html>
